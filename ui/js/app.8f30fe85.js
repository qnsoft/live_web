(function(e){function t(t){for(var o,a,c=t[0],s=t[1],l=t[2],p=0,f=[];p<c.length;p++)a=c[p],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&f.push(r[a][0]),r[a]=0;for(o in s)Object.prototype.hasOwnProperty.call(s,o)&&(e[o]=s[o]);u&&u(t);while(f.length)f.shift()();return i.push.apply(i,l||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],o=!0,c=1;c<n.length;c++){var s=n[c];0!==r[s]&&(o=!1)}o&&(i.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},r={app:0},i=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="/";var c=window["webpackJsonp"]=window["webpackJsonp"]||[],s=c.push.bind(c);c.push=t,c=c.slice();for(var l=0;l<c.length;l++)t(c[l]);var u=s;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"005b":function(e,t,n){},"034f":function(e,t,n){"use strict";n("85ec")},"0601":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var o=n("2b0e"),r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("LivePlayer",{attrs:{playUrl:"ws://192.168.1.21:8080/livews/34020000001320000002/34020000001370000002"}}),n("br"),n("div",{staticStyle:{width:"800px",height:"600px",background:"#999"}},[n("WebrtcPlayer",{attrs:{streamPath:"/api/webrtc/play?streamPath=34020000001320000002/34020000001370000002"}})],1)],1)},i=[],a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"root"},[n("div",{ref:"container",attrs:{id:"container"}}),n("div",{staticClass:"container-shell",staticStyle:{display:"none"}},[n("div",{staticClass:"input"},[e.playing?n("button",{on:{click:e.pause}},[e._v("停止")]):n("button",{on:{click:e.play}},[e._v("播放")])]),e.loaded?n("div",{staticClass:"input",staticStyle:{"line-height":"30px"}},[n("button",{on:{click:e.destroy}},[e._v("销毁")]),e.quieting?n("button",{on:{click:e.cancelMute}},[e._v("取消静音")]):[n("button",{on:{click:e.mute}},[e._v("静音")]),e._v(" 音量 "),n("select",{directives:[{name:"model",rawName:"v-model",value:e.volume,expression:"volume"}],on:{change:[function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.volume=t.target.multiple?n:n[0]},e.volumeChange]}},[n("option",{attrs:{value:"1"}},[e._v("100")]),n("option",{attrs:{value:"0.75"}},[e._v("75")]),n("option",{attrs:{value:"0.5"}},[e._v("50")]),n("option",{attrs:{value:"0.25"}},[e._v("25")])])],n("span",[e._v("旋转")]),n("select",{directives:[{name:"model",rawName:"v-model",value:e.rotate,expression:"rotate"}],on:{change:[function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.rotate=t.target.multiple?n:n[0]},e.rotateChange]}},[n("option",{attrs:{value:"0"}},[e._v("0")]),n("option",{attrs:{value:"90"}},[e._v("90")]),n("option",{attrs:{value:"270"}},[e._v("270")])]),n("button",{on:{click:e.fullscreen}},[e._v("全屏")]),n("button",{on:{click:e.screenShot}},[e._v("截图")]),n("div",{staticStyle:{"line-height":"30px"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.showOperateBtns,expression:"showOperateBtns"}],ref:"operateBtns",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.showOperateBtns)?e._i(e.showOperateBtns,null)>-1:e.showOperateBtns},on:{change:[function(t){var n=e.showOperateBtns,o=t.target,r=!!o.checked;if(Array.isArray(n)){var i=null,a=e._i(n,i);o.checked?a<0&&(e.showOperateBtns=n.concat([i])):a>-1&&(e.showOperateBtns=n.slice(0,a).concat(n.slice(a+1)))}else e.showOperateBtns=r},e.restartPlay]}}),n("span",[e._v("操作按钮")]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.showBandwidth,expression:"showBandwidth"}],ref:"operateBtns",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.showBandwidth)?e._i(e.showBandwidth,null)>-1:e.showBandwidth},on:{change:[function(t){var n=e.showBandwidth,o=t.target,r=!!o.checked;if(Array.isArray(n)){var i=null,a=e._i(n,i);o.checked?a<0&&(e.showBandwidth=n.concat([i])):a>-1&&(e.showBandwidth=n.slice(0,a).concat(n.slice(a+1)))}else e.showBandwidth=r},e.restartPlay]}}),n("span",[e._v("网速")]),e.performance?n("span",[e._v("性能："+e._s(e.performance))]):e._e()])],2):e._e(),n("div",{staticClass:"option",staticStyle:{display:"none"}},[n("span",[e._v("缓冲(秒):")]),n("input",{ref:"buffer",staticStyle:{width:"50px"},attrs:{type:"number",value:"0.2"},on:{change:e.changeBuffer}}),n("input",{directives:[{name:"model",rawName:"v-model",value:e.forceNoOffscreen,expression:"forceNoOffscreen"}],ref:"offscreen",attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.forceNoOffscreen)?e._i(e.forceNoOffscreen,null)>-1:e.forceNoOffscreen},on:{change:[function(t){var n=e.forceNoOffscreen,o=t.target,r=!!o.checked;if(Array.isArray(n)){var i=null,a=e._i(n,i);o.checked?a<0&&(e.forceNoOffscreen=n.concat([i])):a>-1&&(e.forceNoOffscreen=n.slice(0,a).concat(n.slice(a+1)))}else e.forceNoOffscreen=r},e.restartPlay]}}),n("span",[e._v("禁用离屏渲染")]),n("input",{ref:"resize",attrs:{type:"checkbox"},on:{change:e.changeResize}}),n("span",[e._v("禁止画面拉伸")])])])])},c=[],s=(n("a9e3"),{name:"DemoPlayer",props:{playUrl:String},data:function(){return{liveplay:null,wasm:!1,vc:"ff",playing:!1,quieting:!1,loaded:!0,showOperateBtns:!1,showBandwidth:!1,err:"",speed:0,performance:"",volume:10,rotate:0,vod:!1,forceNoOffscreen:!0}},mounted:function(){var e=this;this.create(),window.onerror=function(t){return e.err=t}},unmounted:function(){this.liveplay.destroy()},methods:{create:function(e){e=e||{},this.liveplay=new window.Liveplay(Object.assign({container:document.querySelector("#container"),videoBuffer:Number(this.$refs.buffer.value),isResize:!1,text:"",loadingText:"加载中",debug:!0,showBandwidth:this.showBandwidth,operateBtns:{fullscreen:this.showOperateBtns,screenshot:this.showOperateBtns,play:this.showOperateBtns,audio:this.showOperateBtns},vod:this.vod,forceNoOffscreen:this.forceNoOffscreen,isNotMute:!1},e));var t=this;this.liveplay.on("load",(function(){console.log("on load")})),this.liveplay.on("log",(function(e){console.log("on log",e)})),this.liveplay.on("record",(function(e){console.log("on record:",e)})),this.liveplay.on("pause",(function(){console.log("on pause"),t.playing=!1})),this.liveplay.on("play",(function(){console.log("on play"),t.playing=!0})),this.liveplay.on("fullscreen",(function(e){console.log("on fullscreen",e),this.forceNoOffscreen=e})),this.liveplay.on("mute",(function(e){console.log("on mute静音了",e),t.quieting=e})),this.liveplay.on("audioInfo",(function(e){console.log("audioInfo",e)})),this.liveplay.on("bps",(function(e){console.log("bps",e)}));var n=0;this.liveplay.on("timeUpdate",(function(e){console.log("timeUpdate,old,new,timestamp",n,e,e-n),n=e})),this.liveplay.on("videoInfo",(function(e){console.log("videoInfo",e)})),this.liveplay.on("error",(function(e){console.log("error",e)})),this.liveplay.on("timeout",(function(){console.log("timeout")})),this.liveplay.on("start",(function(){console.log("start")})),this.liveplay.on("performance",(function(e){var n="卡顿";2===e?n="非常流畅":1===e&&(n="流畅"),t.performance=n})),this.liveplay.on("buffer",(function(e){console.log("buffer",e)})),this.liveplay.on("stats",(function(e){console.log("stats",e)})),this.liveplay.on("kBps",(function(e){console.log("kBps",e)})),this.liveplay.on("videoFrame",(function(){})),this.liveplay.on("metadata",(function(){}))},play:function(){var e=this;this.liveplay.on("play",(function(){e.playing=!0,e.loaded=!0,e.liveplay.quieting=e.quieting})),this.playUrl&&(this.liveplay.hasLoaded()?this.liveplay.play(this.playUrl):this.liveplay.on("load",(function(){e.liveplay.play(e.playUrl)})))},mute:function(){this.liveplay.mute()},cancelMute:function(){this.liveplay.cancelMute()},pause:function(){this.liveplay.pause(),this.playing=!1,this.err="",this.performance=""},volumeChange:function(){this.liveplay.setVolume(this.volume)},rotateChange:function(){this.liveplay.setRotate(this.rotate)},destroy:function(){this.liveplay&&this.liveplay.destroy(),this.create(),this.playing=!1,this.loaded=!1,this.performance=""},fullscreen:function(){this.liveplay.setFullscreen(!0)},screenShot:function(){this.liveplay.screenshot()},changeWasm:function(){this.wasm=this.$refs.wasm.checked},restartPlay:function(){this.destroy(),this.play()},changeBuffer:function(){this.liveplay.setBufferTime(Number(this.$refs.buffer.value))},changeResize:function(){var e=this.$refs.resize.checked?1:0;this.liveplay.setScaleMode(e)},changeVod:function(){var e=this.$refs.vod.checked?1:0;this.liveplay.setVod(e)},changeOffscreen:function(){var e=this.$refs.offscreen.checked?1:0;this.liveplay.setNoOffscreen(e)}}}),l=s,u=(n("f4a4"),n("2877")),p=Object(u["a"])(l,a,c,!1,null,null,null),f=p.exports,h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"player-wrap"},[e.rtcStream?[n("video",{attrs:{autoplay:"",muted:"",controls:""},domProps:{srcObject:e.rtcStream,muted:!0}})]:e._e()],2)},d=[],v=n("1da1"),y=(n("bf19"),n("96cf"),n("bc3a")),m=n.n(y),g=function(e,t){return m.a.post(e,t).then((function(e){return e.data}))},w={name:"WebrtcPlayer",rtcPeerConnection:null,data:function(){return{iceConnectionState:"",rtcPeerConnectionInit:!1,rtcStream:null}},props:{streamPath:{type:String,default:""}},created:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.initRtcPeerConnection();case 2:if(console.log("initRtcPeerConnectioned"),!e.streamPath){t.next=7;break}return t.next=6,e.play(e.streamPath);case 6:console.log("played");case 7:case"end":return t.stop()}}),t)})))()},methods:{initRtcPeerConnection:function(){var e=this;return Object(v["a"])(regeneratorRuntime.mark((function t(){var n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=new RTCPeerConnection,n.addTransceiver("video",{direction:"recvonly"}),n.addTransceiver("audio",{direction:"recvonly"}),n.onsignalingstatechange=function(e){console.log("onsignalingstatechange",e)},n.oniceconnectionstatechange=function(e){console.log("oniceconnectionstatechange",e),console.log("oniceconnectionstatechange",n.iceConnectionState)},n.onicecandidate=function(e){console.log("onicecandidate",e)},n.ontrack=function(t){console.log("ontrack",t),"video"===t.track.kind&&(e.rtcStream=t.streams[0])},t.next=9,n.createOffer();case 9:return o=t.sent,t.next=12,n.setLocalDescription(o);case 12:e.rtcPeerConnectionInit=!0,e.$options.rtcPeerConnection=n;case 14:case"end":return t.stop()}}),t)})))()},play:function(e){var t=this;return Object(v["a"])(regeneratorRuntime.mark((function n(){var o,r,i;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=t.$options.rtcPeerConnection,r=o.localDescription.toJSON(),console.log("要传的数据是？",r),n.next=5,g(e,r);case 5:if(i=n.sent,!i.error){n.next=8;break}return n.abrupt("return");case 8:o.setRemoteDescription(new RTCSessionDescription({type:i.type,sdp:i.sdp}));case 9:case"end":return n.stop()}}),n)})))()},close:function(){var e=this.$options.rtcPeerConnection;e&&e.close()}},destroyed:function(){this.close()}},b=w,O=(n("f66d"),Object(u["a"])(b,h,d,!1,null,null,null)),_=O.exports,k={name:"App",components:{LivePlayer:f,WebrtcPlayer:_}},P=k,x=(n("034f"),Object(u["a"])(P,r,i,!1,null,null,null)),B=x.exports;o["a"].config.productionTip=!1,new o["a"]({render:function(e){return e(B)}}).$mount("#app")},"85ec":function(e,t,n){},f4a4:function(e,t,n){"use strict";n("0601")},f66d:function(e,t,n){"use strict";n("005b")}});
//# sourceMappingURL=app.8f30fe85.js.map